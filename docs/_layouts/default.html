---
layout: default
---

{% if site.show_environment_selector %}
<div class="environment-selector">
  <label for="environment-select">Environment:</label>
  <select id="environment-select" onchange="changeEnvironment(this.value)">
    {% for env in site.environments %}
      <option value="{{ env.name }}" {% if page.environment == env.name %}selected{% endif %}>
        {{ env.label }}
      </option>
    {% endfor %}
  </select>
  
  <span class="current-environment" style="background-color: {% for env in site.environments %}{% if page.environment == env.name %}{{ env.color }}{% endif %}{% endfor %}">
    Current: {{ page.environment | default: site.default_environment | capitalize }}
  </span>
</div>

<script>
  function changeEnvironment(environment) {
    // Get current path and replace environment path component if it exists
    const currentPath = window.location.pathname;
    const environmentPattern = /\/(production|staging|test)\//;
    
    if (currentPath.match(environmentPattern)) {
      // If an environment is already in the path, replace it
      const newPath = currentPath.replace(environmentPattern, `/${environment}/`);
      window.location.href = newPath;
    } else {
      // If no environment in the path, add it after the first path component
      const parts = currentPath.split('/');
      if (parts.length > 1) {
        parts.splice(2, 0, environment);
        window.location.href = parts.join('/');
      }
    }
  }
</script>
{% endif %}

{{ content }}
